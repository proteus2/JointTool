function [m1,ml_lumped] = locel(L,C1,C2,Area,Q,Imat,rho,constant,R)

Kl = linstiff(L,C1,C2);

A = -Kl(13:20,13:20)\Kl(13:20,1:12);


[Ml,Ml_lumped] = linmass(L,Area,Q,Imat,rho,constant,R);


m1 = Ml(1:12,1:12)+Ml(1:12,13:20)*A+A'*(Ml(13:20,1:12)+Ml(13:20,13:20)*A);

for i=1:length(constant.lumped.mass)
    
    for j=1:length(constant.lumped.mass{i})
        
        Ml_dum=squeeze(Ml_lumped{i}(j,:,:));
        
        ml_lumped{i}(j,:,:) = Ml_dum(1:12,1:12)+Ml_dum(1:12,13:20)*A+A'*(Ml_dum(13:20,1:12)+Ml_dum(13:20,13:20)*A);
    end
    
end

function Kl = linstiff(L,C1,C2)

C111 = C1(1,1);
C112 = C1(1,2);
C113 = C1(1,3);
C114 = C1(1,4);
C115 = C1(1,5);
C116 = C1(1,6);
C122 = C1(2,2);
C123 = C1(2,3);
C124 = C1(2,4);
C125 = C1(2,5);
C126 = C1(2,6);
C133 = C1(3,3);
C134 = C1(3,4);
C135 = C1(3,5);
C136 = C1(3,6);
C144 = C1(4,4);
C145 = C1(4,5);
C146 = C1(4,6);
C155 = C1(5,5);
C156 = C1(5,6);
C166 = C1(6,6);

C211 = C2(1,1);
C212 = C2(1,2);
C213 = C2(1,3);
C214 = C2(1,4);
C215 = C2(1,5);
C216 = C2(1,6);
C222 = C2(2,2);
C223 = C2(2,3);
C224 = C2(2,4);
C225 = C2(2,5);
C226 = C2(2,6);
C233 = C2(3,3);
C234 = C2(3,4);
C235 = C2(3,5);
C236 = C2(3,6);
C244 = C2(4,4);
C245 = C2(4,5);
C246 = C2(4,6);
C255 = C2(5,5);
C256 = C2(5,6);
C266 = C2(6,6);

Kl = [0.1e1 / L * (C111 + C211) / 0.2e1 0.1e1 / L * (C112 + C212) / 0.2e1 0.1e1 / L * (C113 + C213) / 0.2e1 0.1e1 / L * (C114 + C214) / 0.2e1 -0.1e1 / L * (-(3 * C115) - (3 * C215) + 0.2e1 * C113 * L + C213 * L) / 0.6e1 0.1e1 / L * ((3 * C116) + (3 * C216) + 0.2e1 * C112 * L + C212 * L) / 0.6e1 -0.1e1 / L * (C111 + C211) / 0.2e1 -0.1e1 / L * (C112 + C212) / 0.2e1 -0.1e1 / L * (C113 + C213) / 0.2e1 -0.1e1 / L * (C114 + C214) / 0.2e1 -0.1e1 / L * ((3 * C115) + (3 * C215) + C113 * L + 0.2e1 * C213 * L) / 0.6e1 0.1e1 / L * (-(3 * C116) - (3 * C216) + C112 * L + 0.2e1 * C212 * L) / 0.6e1 -0.1e1 / L * (-C212 + C112) / 0.6e1 -0.1e1 / L * (-C213 + C113) / 0.6e1 0 0 -0.1e1 / L * (-C211 + C111) / 0.6e1 -0.1e1 / L * (-C214 + C114) / 0.6e1 -0.1e1 / L * ((2 * C115) - (2 * C215) + C213 * L + C113 * L) / 0.12e2 0.1e1 / L * (-(2 * C116) + (2 * C216) + C212 * L + C112 * L) / 0.12e2; 0.1e1 / L * (C112 + C212) / 0.2e1 0.1e1 / L * (C122 + C222) / 0.2e1 0.1e1 / L * (C123 + C223) / 0.2e1 0.1e1 / L * (C124 + C224) / 0.2e1 -0.1e1 / L * (-(3 * C225) - (3 * C125) + 0.2e1 * C123 * L + C223 * L) / 0.6e1 0.1e1 / L * (0.2e1 * C122 * L + (3 * C126) + (3 * C226) + C222 * L) / 0.6e1 -0.1e1 / L * (C112 + C212) / 0.2e1 -0.1e1 / L * (C122 + C222) / 0.2e1 -0.1e1 / L * (C123 + C223) / 0.2e1 -0.1e1 / L * (C124 + C224) / 0.2e1 -0.1e1 / L * ((3 * C125) + (3 * C225) + C123 * L + 0.2e1 * C223 * L) / 0.6e1 0.1e1 / L * (-(3 * C126) - (3 * C226) + C122 * L + 0.2e1 * C222 * L) / 0.6e1 -0.1e1 / L * (-C222 + C122) / 0.6e1 -0.1e1 / L * (-C223 + C123) / 0.6e1 0 0 -0.1e1 / L * (-C212 + C112) / 0.6e1 -0.1e1 / L * (-C224 + C124) / 0.6e1 -0.1e1 / L * ((2 * C125) - (2 * C225) + C223 * L + C123 * L) / 0.12e2 0.1e1 / L * (-(2 * C126) + (2 * C226) + C222 * L + C122 * L) / 0.12e2; 0.1e1 / L * (C113 + C213) / 0.2e1 0.1e1 / L * (C123 + C223) / 0.2e1 0.1e1 / L * (C133 + C233) / 0.2e1 0.1e1 / L * (C134 + C234) / 0.2e1 -0.1e1 / L * (-(3 * C135) - (3 * C235) + 0.2e1 * C133 * L + C233 * L) / 0.6e1 0.1e1 / L * (0.2e1 * C123 * L + (3 * C136) + (3 * C236) + C223 * L) / 0.6e1 -0.1e1 / L * (C113 + C213) / 0.2e1 -0.1e1 / L * (C123 + C223) / 0.2e1 -0.1e1 / L * (C133 + C233) / 0.2e1 -0.1e1 / L * (C134 + C234) / 0.2e1 -0.1e1 / L * ((3 * C135) + (3 * C235) + C133 * L + 0.2e1 * C233 * L) / 0.6e1 0.1e1 / L * (-(3 * C136) - (3 * C236) + C123 * L + 0.2e1 * C223 * L) / 0.6e1 -0.1e1 / L * (-C223 + C123) / 0.6e1 -0.1e1 / L * (-C233 + C133) / 0.6e1 0 0 -0.1e1 / L * (-C213 + C113) / 0.6e1 -0.1e1 / L * (-C234 + C134) / 0.6e1 -0.1e1 / L * ((2 * C135) - (2 * C235) + C233 * L + C133 * L) / 0.12e2 0.1e1 / L * (-(2 * C136) + (2 * C236) + C223 * L + C123 * L) / 0.12e2; 0.1e1 / L * (C114 + C214) / 0.2e1 0.1e1 / L * (C124 + C224) / 0.2e1 0.1e1 / L * (C134 + C234) / 0.2e1 0.1e1 / L * (C144 + C244) / 0.2e1 -0.1e1 / L * (-(3 * C145) - (3 * C245) + 0.2e1 * C134 * L + C234 * L) / 0.6e1 0.1e1 / L * ((3 * C146) + (3 * C246) + 0.2e1 * C124 * L + C224 * L) / 0.6e1 -0.1e1 / L * (C114 + C214) / 0.2e1 -0.1e1 / L * (C124 + C224) / 0.2e1 -0.1e1 / L * (C134 + C234) / 0.2e1 -0.1e1 / L * (C144 + C244) / 0.2e1 -0.1e1 / L * ((3 * C145) + (3 * C245) + C134 * L + 0.2e1 * C234 * L) / 0.6e1 0.1e1 / L * (-(3 * C146) - (3 * C246) + C124 * L + 0.2e1 * C224 * L) / 0.6e1 -0.1e1 / L * (-C224 + C124) / 0.6e1 -0.1e1 / L * (-C234 + C134) / 0.6e1 0 0 -0.1e1 / L * (-C214 + C114) / 0.6e1 -0.1e1 / L * (-C244 + C144) / 0.6e1 -0.1e1 / L * ((2 * C145) - (2 * C245) + C234 * L + C134 * L) / 0.12e2 0.1e1 / L * (-(2 * C146) + (2 * C246) + C224 * L + C124 * L) / 0.12e2; -0.1e1 / L * (-(3 * C115) - (3 * C215) + 0.2e1 * C113 * L + C213 * L) / 0.6e1 -0.1e1 / L * (-(3 * C225) - (3 * C125) + 0.2e1 * C123 * L + C223 * L) / 0.6e1 -0.1e1 / L * (-(3 * C135) - (3 * C235) + 0.2e1 * C133 * L + C233 * L) / 0.6e1 -0.1e1 / L * (-(3 * C145) - (3 * C245) + 0.2e1 * C134 * L + C234 * L) / 0.6e1 0.1e1 / L * (0.3e1 * C133 * L ^ 2 - 0.4e1 * C235 * L - 0.8e1 * C135 * L + (6 * C155) + (6 * C255) + C233 * L ^ 2) / 0.12e2 -0.1e1 / L * (0.3e1 * C123 * L ^ 2 - 0.4e1 * C125 * L - (6 * C156) - (6 * C256) - 0.2e1 * C225 * L + 0.4e1 * C136 * L + 0.2e1 * C236 * L + C223 * L ^ 2) / 0.12e2 0.1e1 / L * (-(3 * C115) - (3 * C215) + 0.2e1 * C113 * L + C213 * L) / 0.6e1 0.1e1 / L * (-(3 * C225) - (3 * C125) + 0.2e1 * C123 * L + C223 * L) / 0.6e1 0.1e1 / L * (-(3 * C135) - (3 * C235) + 0.2e1 * C133 * L + C233 * L) / 0.6e1 0.1e1 / L * (-(3 * C145) - (3 * C245) + 0.2e1 * C134 * L + C234 * L) / 0.6e1 0.1e1 / L * (-(6 * C155) - (6 * C255) + 0.2e1 * C135 * L - 0.2e1 * C235 * L + C133 * L ^ 2 + C233 * L ^ 2) / 0.12e2 -0.1e1 / L * (-0.2e1 * C125 * L + C123 * L ^ 2 - 0.4e1 * C225 * L + C223 * L ^ 2 + (6 * C156) + (6 * C256) - 0.4e1 * C136 * L - 0.2e1 * C236 * L) / 0.12e2 (C225 - C125 + C123 * L) / L / 0.6e1 (C235 - C135 + C133 * L) / L / 0.6e1 -C223 / 0.60e2 + C123 / 0.60e2 -C233 / 0.60e2 + C133 / 0.60e2 (C215 - C115 + C113 * L) / L / 0.6e1 (C245 - C145 + C134 * L) / L / 0.6e1 0.1e1 / L * (0.3e1 * C133 * L ^ 2 - (10 * C155) + (10 * C255) + 0.5e1 * C135 * L - 0.5e1 * C235 * L + 0.2e1 * C233 * L ^ 2) / 0.60e2 -0.1e1 / L * (0.3e1 * C123 * L ^ 2 + (10 * C156) - (10 * C256) - 0.5e1 * C225 * L - 0.10e2 * C136 * L - 0.5e1 * C125 * L + 0.2e1 * C223 * L ^ 2) / 0.60e2; 0.1e1 / L * ((3 * C116) + (3 * C216) + 0.2e1 * C112 * L + C212 * L) / 0.6e1 0.1e1 / L * (0.2e1 * C122 * L + (3 * C126) + (3 * C226) + C222 * L) / 0.6e1 0.1e1 / L * (0.2e1 * C123 * L + (3 * C136) + (3 * C236) + C223 * L) / 0.6e1 0.1e1 / L * ((3 * C146) + (3 * C246) + 0.2e1 * C124 * L + C224 * L) / 0.6e1 -0.1e1 / L * (0.3e1 * C123 * L ^ 2 - 0.4e1 * C125 * L - (6 * C156) - (6 * C256) - 0.2e1 * C225 * L + 0.4e1 * C136 * L + 0.2e1 * C236 * L + C223 * L ^ 2) / 0.12e2 0.1e1 / L * (0.3e1 * C122 * L ^ 2 + 0.8e1 * C126 * L + 0.4e1 * C226 * L + C222 * L ^ 2 + (6 * C166) + (6 * C266)) / 0.12e2 -0.1e1 / L * ((3 * C116) + (3 * C216) + 0.2e1 * C112 * L + C212 * L) / 0.6e1 -0.1e1 / L * (0.2e1 * C122 * L + (3 * C126) + (3 * C226) + C222 * L) / 0.6e1 -0.1e1 / L * (0.2e1 * C123 * L + (3 * C136) + (3 * C236) + C223 * L) / 0.6e1 -0.1e1 / L * ((3 * C146) + (3 * C246) + 0.2e1 * C124 * L + C224 * L) / 0.6e1 -0.1e1 / L * (C123 * L ^ 2 + 0.2e1 * C136 * L + 0.4e1 * C236 * L + C223 * L ^ 2 + (6 * C156) + (6 * C256) + 0.4e1 * C125 * L + 0.2e1 * C225 * L) / 0.12e2 0.1e1 / L * (C122 * L ^ 2 + 0.2e1 * C226 * L - 0.2e1 * C126 * L + C222 * L ^ 2 - (6 * C166) - (6 * C266)) / 0.12e2 -0.1e1 / L * (-C226 + C126 + C122 * L) / 0.6e1 -0.1e1 / L * (-C236 + C136 + C123 * L) / 0.6e1 C222 / 0.60e2 - C122 / 0.60e2 C223 / 0.60e2 - C123 / 0.60e2 -0.1e1 / L * (-C216 + C116 + C112 * L) / 0.6e1 -0.1e1 / L * (-C246 + C146 + C124 * L) / 0.6e1 -0.1e1 / L * (0.3e1 * C123 * L ^ 2 + (10 * C156) - (10 * C256) + 0.5e1 * C236 * L + 0.10e2 * C125 * L + 0.5e1 * C136 * L + 0.2e1 * C223 * L ^ 2) / 0.60e2 0.1e1 / L * (0.3e1 * C122 * L ^ 2 - (10 * C166) + (10 * C266) - 0.5e1 * C126 * L + 0.5e1 * C226 * L + 0.2e1 * C222 * L ^ 2) / 0.60e2; -0.1e1 / L * (C111 + C211) / 0.2e1 -0.1e1 / L * (C112 + C212) / 0.2e1 -0.1e1 / L * (C113 + C213) / 0.2e1 -0.1e1 / L * (C114 + C214) / 0.2e1 0.1e1 / L * (-(3 * C115) - (3 * C215) + 0.2e1 * C113 * L + C213 * L) / 0.6e1 -0.1e1 / L * ((3 * C116) + (3 * C216) + 0.2e1 * C112 * L + C212 * L) / 0.6e1 0.1e1 / L * (C111 + C211) / 0.2e1 0.1e1 / L * (C112 + C212) / 0.2e1 0.1e1 / L * (C113 + C213) / 0.2e1 0.1e1 / L * (C114 + C214) / 0.2e1 0.1e1 / L * ((3 * C115) + (3 * C215) + C113 * L + 0.2e1 * C213 * L) / 0.6e1 -0.1e1 / L * (-(3 * C116) - (3 * C216) + C112 * L + 0.2e1 * C212 * L) / 0.6e1 0.1e1 / L * (-C212 + C112) / 0.6e1 0.1e1 / L * (-C213 + C113) / 0.6e1 0 0 0.1e1 / L * (-C211 + C111) / 0.6e1 0.1e1 / L * (-C214 + C114) / 0.6e1 0.1e1 / L * ((2 * C115) - (2 * C215) + C213 * L + C113 * L) / 0.12e2 -0.1e1 / L * (-(2 * C116) + (2 * C216) + C212 * L + C112 * L) / 0.12e2; -0.1e1 / L * (C112 + C212) / 0.2e1 -0.1e1 / L * (C122 + C222) / 0.2e1 -0.1e1 / L * (C123 + C223) / 0.2e1 -0.1e1 / L * (C124 + C224) / 0.2e1 0.1e1 / L * (-(3 * C225) - (3 * C125) + 0.2e1 * C123 * L + C223 * L) / 0.6e1 -0.1e1 / L * (0.2e1 * C122 * L + (3 * C126) + (3 * C226) + C222 * L) / 0.6e1 0.1e1 / L * (C112 + C212) / 0.2e1 0.1e1 / L * (C122 + C222) / 0.2e1 0.1e1 / L * (C123 + C223) / 0.2e1 0.1e1 / L * (C124 + C224) / 0.2e1 0.1e1 / L * ((3 * C125) + (3 * C225) + C123 * L + 0.2e1 * C223 * L) / 0.6e1 -0.1e1 / L * (-(3 * C126) - (3 * C226) + C122 * L + 0.2e1 * C222 * L) / 0.6e1 0.1e1 / L * (-C222 + C122) / 0.6e1 0.1e1 / L * (-C223 + C123) / 0.6e1 0 0 0.1e1 / L * (-C212 + C112) / 0.6e1 0.1e1 / L * (-C224 + C124) / 0.6e1 0.1e1 / L * ((2 * C125) - (2 * C225) + C223 * L + C123 * L) / 0.12e2 -0.1e1 / L * (-(2 * C126) + (2 * C226) + C222 * L + C122 * L) / 0.12e2; -0.1e1 / L * (C113 + C213) / 0.2e1 -0.1e1 / L * (C123 + C223) / 0.2e1 -0.1e1 / L * (C133 + C233) / 0.2e1 -0.1e1 / L * (C134 + C234) / 0.2e1 0.1e1 / L * (-(3 * C135) - (3 * C235) + 0.2e1 * C133 * L + C233 * L) / 0.6e1 -0.1e1 / L * (0.2e1 * C123 * L + (3 * C136) + (3 * C236) + C223 * L) / 0.6e1 0.1e1 / L * (C113 + C213) / 0.2e1 0.1e1 / L * (C123 + C223) / 0.2e1 0.1e1 / L * (C133 + C233) / 0.2e1 0.1e1 / L * (C134 + C234) / 0.2e1 0.1e1 / L * ((3 * C135) + (3 * C235) + C133 * L + 0.2e1 * C233 * L) / 0.6e1 -0.1e1 / L * (-(3 * C136) - (3 * C236) + C123 * L + 0.2e1 * C223 * L) / 0.6e1 0.1e1 / L * (-C223 + C123) / 0.6e1 0.1e1 / L * (-C233 + C133) / 0.6e1 0 0 0.1e1 / L * (-C213 + C113) / 0.6e1 0.1e1 / L * (-C234 + C134) / 0.6e1 0.1e1 / L * ((2 * C135) - (2 * C235) + C233 * L + C133 * L) / 0.12e2 -0.1e1 / L * (-(2 * C136) + (2 * C236) + C223 * L + C123 * L) / 0.12e2; -0.1e1 / L * (C114 + C214) / 0.2e1 -0.1e1 / L * (C124 + C224) / 0.2e1 -0.1e1 / L * (C134 + C234) / 0.2e1 -0.1e1 / L * (C144 + C244) / 0.2e1 0.1e1 / L * (-(3 * C145) - (3 * C245) + 0.2e1 * C134 * L + C234 * L) / 0.6e1 -0.1e1 / L * ((3 * C146) + (3 * C246) + 0.2e1 * C124 * L + C224 * L) / 0.6e1 0.1e1 / L * (C114 + C214) / 0.2e1 0.1e1 / L * (C124 + C224) / 0.2e1 0.1e1 / L * (C134 + C234) / 0.2e1 0.1e1 / L * (C144 + C244) / 0.2e1 0.1e1 / L * ((3 * C145) + (3 * C245) + C134 * L + 0.2e1 * C234 * L) / 0.6e1 -0.1e1 / L * (-(3 * C146) - (3 * C246) + C124 * L + 0.2e1 * C224 * L) / 0.6e1 0.1e1 / L * (-C224 + C124) / 0.6e1 0.1e1 / L * (-C234 + C134) / 0.6e1 0 0 0.1e1 / L * (-C214 + C114) / 0.6e1 0.1e1 / L * (-C244 + C144) / 0.6e1 0.1e1 / L * ((2 * C145) - (2 * C245) + C234 * L + C134 * L) / 0.12e2 -0.1e1 / L * (-(2 * C146) + (2 * C246) + C224 * L + C124 * L) / 0.12e2; -0.1e1 / L * ((3 * C115) + (3 * C215) + C113 * L + 0.2e1 * C213 * L) / 0.6e1 -0.1e1 / L * ((3 * C125) + (3 * C225) + C123 * L + 0.2e1 * C223 * L) / 0.6e1 -0.1e1 / L * ((3 * C135) + (3 * C235) + C133 * L + 0.2e1 * C233 * L) / 0.6e1 -0.1e1 / L * ((3 * C145) + (3 * C245) + C134 * L + 0.2e1 * C234 * L) / 0.6e1 0.1e1 / L * (-(6 * C155) - (6 * C255) + 0.2e1 * C135 * L - 0.2e1 * C235 * L + C133 * L ^ 2 + C233 * L ^ 2) / 0.12e2 -0.1e1 / L * (C123 * L ^ 2 + 0.2e1 * C136 * L + 0.4e1 * C236 * L + C223 * L ^ 2 + (6 * C156) + (6 * C256) + 0.4e1 * C125 * L + 0.2e1 * C225 * L) / 0.12e2 0.1e1 / L * ((3 * C115) + (3 * C215) + C113 * L + 0.2e1 * C213 * L) / 0.6e1 0.1e1 / L * ((3 * C125) + (3 * C225) + C123 * L + 0.2e1 * C223 * L) / 0.6e1 0.1e1 / L * ((3 * C135) + (3 * C235) + C133 * L + 0.2e1 * C233 * L) / 0.6e1 0.1e1 / L * ((3 * C145) + (3 * C245) + C134 * L + 0.2e1 * C234 * L) / 0.6e1 0.1e1 / L * ((6 * C255) + (6 * C155) + 0.4e1 * C135 * L + 0.8e1 * C235 * L + C133 * L ^ 2 + 0.3e1 * C233 * L ^ 2) / 0.12e2 -0.1e1 / L * (0.2e1 * C125 * L - (6 * C256) - (6 * C156) - 0.2e1 * C136 * L + 0.4e1 * C225 * L + C123 * L ^ 2 - 0.4e1 * C236 * L + 0.3e1 * C223 * L ^ 2) / 0.12e2 0.1e1 / L * (C125 - C225 - C223 * L) / 0.6e1 0.1e1 / L * (C135 - C235 - C233 * L) / 0.6e1 C223 / 0.60e2 - C123 / 0.60e2 C233 / 0.60e2 - C133 / 0.60e2 0.1e1 / L * (-C215 + C115 - C213 * L) / 0.6e1 0.1e1 / L * (-C245 + C145 - C234 * L) / 0.6e1 0.1e1 / L * (-(10 * C255) + (10 * C155) + 0.5e1 * C135 * L - 0.5e1 * C235 * L + 0.2e1 * C133 * L ^ 2 + 0.3e1 * C233 * L ^ 2) / 0.60e2 -0.1e1 / L * ((10 * C256) - (10 * C156) + 0.5e1 * C225 * L + 0.5e1 * C125 * L + 0.2e1 * C123 * L ^ 2 + 0.10e2 * C236 * L + 0.3e1 * C223 * L ^ 2) / 0.60e2; 0.1e1 / L * (-(3 * C116) - (3 * C216) + C112 * L + 0.2e1 * C212 * L) / 0.6e1 0.1e1 / L * (-(3 * C126) - (3 * C226) + C122 * L + 0.2e1 * C222 * L) / 0.6e1 0.1e1 / L * (-(3 * C136) - (3 * C236) + C123 * L + 0.2e1 * C223 * L) / 0.6e1 0.1e1 / L * (-(3 * C146) - (3 * C246) + C124 * L + 0.2e1 * C224 * L) / 0.6e1 -0.1e1 / L * (-0.2e1 * C125 * L + C123 * L ^ 2 - 0.4e1 * C225 * L + C223 * L ^ 2 + (6 * C156) + (6 * C256) - 0.4e1 * C136 * L - 0.2e1 * C236 * L) / 0.12e2 0.1e1 / L * (C122 * L ^ 2 + 0.2e1 * C226 * L - 0.2e1 * C126 * L + C222 * L ^ 2 - (6 * C166) - (6 * C266)) / 0.12e2 -0.1e1 / L * (-(3 * C116) - (3 * C216) + C112 * L + 0.2e1 * C212 * L) / 0.6e1 -0.1e1 / L * (-(3 * C126) - (3 * C226) + C122 * L + 0.2e1 * C222 * L) / 0.6e1 -0.1e1 / L * (-(3 * C136) - (3 * C236) + C123 * L + 0.2e1 * C223 * L) / 0.6e1 -0.1e1 / L * (-(3 * C146) - (3 * C246) + C124 * L + 0.2e1 * C224 * L) / 0.6e1 -0.1e1 / L * (0.2e1 * C125 * L - (6 * C256) - (6 * C156) - 0.2e1 * C136 * L + 0.4e1 * C225 * L + C123 * L ^ 2 - 0.4e1 * C236 * L + 0.3e1 * C223 * L ^ 2) / 0.12e2 0.1e1 / L * (-0.4e1 * C126 * L + (6 * C266) + (6 * C166) - 0.8e1 * C226 * L + C122 * L ^ 2 + 0.3e1 * C222 * L ^ 2) / 0.12e2 0.1e1 / L * (C126 + C222 * L - C226) / 0.6e1 0.1e1 / L * (C136 - C236 + C223 * L) / 0.6e1 -C222 / 0.60e2 + C122 / 0.60e2 -C223 / 0.60e2 + C123 / 0.60e2 0.1e1 / L * (-C216 + C116 + C212 * L) / 0.6e1 0.1e1 / L * (-C246 + C146 + C224 * L) / 0.6e1 -0.1e1 / L * (0.2e1 * C123 * L ^ 2 - (10 * C156) + (10 * C256) - 0.5e1 * C236 * L - 0.10e2 * C225 * L - 0.5e1 * C136 * L + 0.3e1 * C223 * L ^ 2) / 0.60e2 0.1e1 / L * (0.2e1 * C122 * L ^ 2 + (10 * C166) - (10 * C266) - 0.5e1 * C126 * L + 0.5e1 * C226 * L + 0.3e1 * C222 * L ^ 2) / 0.60e2; -0.1e1 / L * (-C212 + C112) / 0.6e1 -0.1e1 / L * (-C222 + C122) / 0.6e1 -0.1e1 / L * (-C223 + C123) / 0.6e1 -0.1e1 / L * (-C224 + C124) / 0.6e1 (C225 - C125 + C123 * L) / L / 0.6e1 -0.1e1 / L * (-C226 + C126 + C122 * L) / 0.6e1 0.1e1 / L * (-C212 + C112) / 0.6e1 0.1e1 / L * (-C222 + C122) / 0.6e1 0.1e1 / L * (-C223 + C123) / 0.6e1 0.1e1 / L * (-C224 + C124) / 0.6e1 0.1e1 / L * (C125 - C225 - C223 * L) / 0.6e1 0.1e1 / L * (C126 + C222 * L - C226) / 0.6e1 0.1e1 / L * (C122 + C222) / 0.6e1 0.1e1 / L * (C123 + C223) / 0.6e1 0.1e1 / L * (-C222 + C122) / 0.30e2 0.1e1 / L * (-C223 + C123) / 0.30e2 0.1e1 / L * (C112 + C212) / 0.6e1 0.1e1 / L * (C124 + C224) / 0.6e1 0.1e1 / L * ((10 * C125) + (10 * C225) - C223 * L + C123 * L) / 0.60e2 -0.1e1 / L * (-(10 * C126) - (10 * C226) - C222 * L + C122 * L) / 0.60e2; -0.1e1 / L * (-C213 + C113) / 0.6e1 -0.1e1 / L * (-C223 + C123) / 0.6e1 -0.1e1 / L * (-C233 + C133) / 0.6e1 -0.1e1 / L * (-C234 + C134) / 0.6e1 (C235 - C135 + C133 * L) / L / 0.6e1 -0.1e1 / L * (-C236 + C136 + C123 * L) / 0.6e1 0.1e1 / L * (-C213 + C113) / 0.6e1 0.1e1 / L * (-C223 + C123) / 0.6e1 0.1e1 / L * (-C233 + C133) / 0.6e1 0.1e1 / L * (-C234 + C134) / 0.6e1 0.1e1 / L * (C135 - C235 - C233 * L) / 0.6e1 0.1e1 / L * (C136 - C236 + C223 * L) / 0.6e1 0.1e1 / L * (C123 + C223) / 0.6e1 0.1e1 / L * (C133 + C233) / 0.6e1 0.1e1 / L * (-C223 + C123) / 0.30e2 0.1e1 / L * (-C233 + C133) / 0.30e2 0.1e1 / L * (C113 + C213) / 0.6e1 0.1e1 / L * (C134 + C234) / 0.6e1 0.1e1 / L * ((10 * C135) + (10 * C235) - C233 * L + C133 * L) / 0.60e2 -0.1e1 / L * (-(10 * C136) - (10 * C236) - C223 * L + C123 * L) / 0.60e2; 0 0 0 0 -C223 / 0.60e2 + C123 / 0.60e2 C222 / 0.60e2 - C122 / 0.60e2 0 0 0 0 C223 / 0.60e2 - C123 / 0.60e2 -C222 / 0.60e2 + C122 / 0.60e2 0.1e1 / L * (-C222 + C122) / 0.30e2 0.1e1 / L * (-C223 + C123) / 0.30e2 0.1e1 / L * (C122 + C222) / 0.40e2 0.1e1 / L * (C123 + C223) / 0.40e2 0.1e1 / L * (-C212 + C112) / 0.30e2 0.1e1 / L * (-C224 + C124) / 0.30e2 -0.1e1 / L * (C123 * L + C223 * L - (4 * C125) + (4 * C225)) / 0.120e3 0.1e1 / L * (C122 * L + C222 * L + (4 * C126) - (4 * C226)) / 0.120e3; 0 0 0 0 -C233 / 0.60e2 + C133 / 0.60e2 C223 / 0.60e2 - C123 / 0.60e2 0 0 0 0 C233 / 0.60e2 - C133 / 0.60e2 -C223 / 0.60e2 + C123 / 0.60e2 0.1e1 / L * (-C223 + C123) / 0.30e2 0.1e1 / L * (-C233 + C133) / 0.30e2 0.1e1 / L * (C123 + C223) / 0.40e2 0.1e1 / L * (C133 + C233) / 0.40e2 0.1e1 / L * (-C213 + C113) / 0.30e2 0.1e1 / L * (-C234 + C134) / 0.30e2 -0.1e1 / L * (C133 * L + C233 * L - (4 * C135) + (4 * C235)) / 0.120e3 0.1e1 / L * (C123 * L + C223 * L + (4 * C136) - (4 * C236)) / 0.120e3; -0.1e1 / L * (-C211 + C111) / 0.6e1 -0.1e1 / L * (-C212 + C112) / 0.6e1 -0.1e1 / L * (-C213 + C113) / 0.6e1 -0.1e1 / L * (-C214 + C114) / 0.6e1 (C215 - C115 + C113 * L) / L / 0.6e1 -0.1e1 / L * (-C216 + C116 + C112 * L) / 0.6e1 0.1e1 / L * (-C211 + C111) / 0.6e1 0.1e1 / L * (-C212 + C112) / 0.6e1 0.1e1 / L * (-C213 + C113) / 0.6e1 0.1e1 / L * (-C214 + C114) / 0.6e1 0.1e1 / L * (-C215 + C115 - C213 * L) / 0.6e1 0.1e1 / L * (-C216 + C116 + C212 * L) / 0.6e1 0.1e1 / L * (C112 + C212) / 0.6e1 0.1e1 / L * (C113 + C213) / 0.6e1 0.1e1 / L * (-C212 + C112) / 0.30e2 0.1e1 / L * (-C213 + C113) / 0.30e2 0.1e1 / L * (C111 + C211) / 0.6e1 0.1e1 / L * (C114 + C214) / 0.6e1 0.1e1 / L * ((10 * C115) + (10 * C215) - C213 * L + C113 * L) / 0.60e2 -0.1e1 / L * (-(10 * C116) - (10 * C216) - C212 * L + C112 * L) / 0.60e2; -0.1e1 / L * (-C214 + C114) / 0.6e1 -0.1e1 / L * (-C224 + C124) / 0.6e1 -0.1e1 / L * (-C234 + C134) / 0.6e1 -0.1e1 / L * (-C244 + C144) / 0.6e1 (C245 - C145 + C134 * L) / L / 0.6e1 -0.1e1 / L * (-C246 + C146 + C124 * L) / 0.6e1 0.1e1 / L * (-C214 + C114) / 0.6e1 0.1e1 / L * (-C224 + C124) / 0.6e1 0.1e1 / L * (-C234 + C134) / 0.6e1 0.1e1 / L * (-C244 + C144) / 0.6e1 0.1e1 / L * (-C245 + C145 - C234 * L) / 0.6e1 0.1e1 / L * (-C246 + C146 + C224 * L) / 0.6e1 0.1e1 / L * (C124 + C224) / 0.6e1 0.1e1 / L * (C134 + C234) / 0.6e1 0.1e1 / L * (-C224 + C124) / 0.30e2 0.1e1 / L * (-C234 + C134) / 0.30e2 0.1e1 / L * (C114 + C214) / 0.6e1 0.1e1 / L * (C144 + C244) / 0.6e1 0.1e1 / L * ((10 * C145) + (10 * C245) - C234 * L + C134 * L) / 0.60e2 -0.1e1 / L * (-(10 * C146) - (10 * C246) - C224 * L + C124 * L) / 0.60e2; -0.1e1 / L * ((2 * C115) - (2 * C215) + C213 * L + C113 * L) / 0.12e2 -0.1e1 / L * ((2 * C125) - (2 * C225) + C223 * L + C123 * L) / 0.12e2 -0.1e1 / L * ((2 * C135) - (2 * C235) + C233 * L + C133 * L) / 0.12e2 -0.1e1 / L * ((2 * C145) - (2 * C245) + C234 * L + C134 * L) / 0.12e2 0.1e1 / L * (0.3e1 * C133 * L ^ 2 - (10 * C155) + (10 * C255) + 0.5e1 * C135 * L - 0.5e1 * C235 * L + 0.2e1 * C233 * L ^ 2) / 0.60e2 -0.1e1 / L * (0.3e1 * C123 * L ^ 2 + (10 * C156) - (10 * C256) + 0.5e1 * C236 * L + 0.10e2 * C125 * L + 0.5e1 * C136 * L + 0.2e1 * C223 * L ^ 2) / 0.60e2 0.1e1 / L * ((2 * C115) - (2 * C215) + C213 * L + C113 * L) / 0.12e2 0.1e1 / L * ((2 * C125) - (2 * C225) + C223 * L + C123 * L) / 0.12e2 0.1e1 / L * ((2 * C135) - (2 * C235) + C233 * L + C133 * L) / 0.12e2 0.1e1 / L * ((2 * C145) - (2 * C245) + C234 * L + C134 * L) / 0.12e2 0.1e1 / L * (-(10 * C255) + (10 * C155) + 0.5e1 * C135 * L - 0.5e1 * C235 * L + 0.2e1 * C133 * L ^ 2 + 0.3e1 * C233 * L ^ 2) / 0.60e2 -0.1e1 / L * (0.2e1 * C123 * L ^ 2 - (10 * C156) + (10 * C256) - 0.5e1 * C236 * L - 0.10e2 * C225 * L - 0.5e1 * C136 * L + 0.3e1 * C223 * L ^ 2) / 0.60e2 0.1e1 / L * ((10 * C125) + (10 * C225) - C223 * L + C123 * L) / 0.60e2 0.1e1 / L * ((10 * C135) + (10 * C235) - C233 * L + C133 * L) / 0.60e2 -0.1e1 / L * (C123 * L + C223 * L - (4 * C125) + (4 * C225)) / 0.120e3 -0.1e1 / L * (C133 * L + C233 * L - (4 * C135) + (4 * C235)) / 0.120e3 0.1e1 / L * ((10 * C115) + (10 * C215) - C213 * L + C113 * L) / 0.60e2 0.1e1 / L * ((10 * C145) + (10 * C245) - C234 * L + C134 * L) / 0.60e2 0.1e1 / L * (C133 * L ^ 2 + (10 * C155) + (10 * C255) + 0.2e1 * C135 * L - 0.2e1 * C235 * L + C233 * L ^ 2) / 0.60e2 -0.1e1 / L * (C123 * L ^ 2 - (10 * C156) - (10 * C256) - C136 * L + C236 * L + C125 * L - C225 * L + C223 * L ^ 2) / 0.60e2; 0.1e1 / L * (-(2 * C116) + (2 * C216) + C212 * L + C112 * L) / 0.12e2 0.1e1 / L * (-(2 * C126) + (2 * C226) + C222 * L + C122 * L) / 0.12e2 0.1e1 / L * (-(2 * C136) + (2 * C236) + C223 * L + C123 * L) / 0.12e2 0.1e1 / L * (-(2 * C146) + (2 * C246) + C224 * L + C124 * L) / 0.12e2 -0.1e1 / L * (0.3e1 * C123 * L ^ 2 + (10 * C156) - (10 * C256) - 0.5e1 * C225 * L - 0.10e2 * C136 * L - 0.5e1 * C125 * L + 0.2e1 * C223 * L ^ 2) / 0.60e2 0.1e1 / L * (0.3e1 * C122 * L ^ 2 - (10 * C166) + (10 * C266) - 0.5e1 * C126 * L + 0.5e1 * C226 * L + 0.2e1 * C222 * L ^ 2) / 0.60e2 -0.1e1 / L * (-(2 * C116) + (2 * C216) + C212 * L + C112 * L) / 0.12e2 -0.1e1 / L * (-(2 * C126) + (2 * C226) + C222 * L + C122 * L) / 0.12e2 -0.1e1 / L * (-(2 * C136) + (2 * C236) + C223 * L + C123 * L) / 0.12e2 -0.1e1 / L * (-(2 * C146) + (2 * C246) + C224 * L + C124 * L) / 0.12e2 -0.1e1 / L * ((10 * C256) - (10 * C156) + 0.5e1 * C225 * L + 0.5e1 * C125 * L + 0.2e1 * C123 * L ^ 2 + 0.10e2 * C236 * L + 0.3e1 * C223 * L ^ 2) / 0.60e2 0.1e1 / L * (0.2e1 * C122 * L ^ 2 + (10 * C166) - (10 * C266) - 0.5e1 * C126 * L + 0.5e1 * C226 * L + 0.3e1 * C222 * L ^ 2) / 0.60e2 -0.1e1 / L * (-(10 * C126) - (10 * C226) - C222 * L + C122 * L) / 0.60e2 -0.1e1 / L * (-(10 * C136) - (10 * C236) - C223 * L + C123 * L) / 0.60e2 0.1e1 / L * (C122 * L + C222 * L + (4 * C126) - (4 * C226)) / 0.120e3 0.1e1 / L * (C123 * L + C223 * L + (4 * C136) - (4 * C236)) / 0.120e3 -0.1e1 / L * (-(10 * C116) - (10 * C216) - C212 * L + C112 * L) / 0.60e2 -0.1e1 / L * (-(10 * C146) - (10 * C246) - C224 * L + C124 * L) / 0.60e2 -0.1e1 / L * (C123 * L ^ 2 - (10 * C156) - (10 * C256) - C136 * L + C236 * L + C125 * L - C225 * L + C223 * L ^ 2) / 0.60e2 0.1e1 / L * (C122 * L ^ 2 + (10 * C166) + (10 * C266) - 0.2e1 * C126 * L + 0.2e1 * C226 * L + C222 * L ^ 2) / 0.60e2;];



function [Ml,Ml_lumped] = linmass(L,A,Q,Imat,rho,constant,R)

Q2 = Q(1);
Q3 = Q(2);
I11 = Imat(1,1);
I22 = Imat(2,2);
I23 = Imat(2,3);
I33 = Imat(3,3);

Ml = [(1/3).*A.*L.*rho,0,0,0,(1/3).*L.*Q2.*rho,(-1/3).*L.*Q3.*rho,(1/6).*A.*L.*rho,0, ...
  0,0,(1/6).*L.*Q2.*rho,(-1/6).*L.*Q3.*rho,0,0,0,0,(1/12).*A.*L.*rho,0,(1/12).* ...
  L.*Q2.*rho,(-1/12).*L.*Q3.*rho;0,(1/3).*A.*L.*rho,0,(-1/3).*L.*Q2.*rho,0,0,0,( ...
  1/6).*A.*L.*rho,0,(-1/6).*L.*Q2.*rho,0,0,(1/12).*A.*L.*rho,0,(1/120).*A.*L.*rho, ...
  0,0,(-1/12).*L.*Q2.*rho,0,0;0,0,(1/3).*A.*L.*rho,(1/3).*L.*Q3.*rho,0,0,0,0,( ...
  1/6).*A.*L.*rho,(1/6).*L.*Q3.*rho,0,0,0,(1/12).*A.*L.*rho,0,(1/120).*A.*L.*rho, ...
  0,(1/12).*L.*Q3.*rho,0,0;0,(-1/3).*L.*Q2.*rho,(1/3).*L.*Q3.*rho,(1/3).*I11.* ...
  L.*rho,0,0,0,(-1/6).*L.*Q2.*rho,(1/6).*L.*Q3.*rho,(1/6).*I11.*L.*rho,0,0,(-1/12) ...
  .*L.*Q2.*rho,(1/12).*L.*Q3.*rho,(-1/120).*L.*Q2.*rho,(1/120).*L.*Q3.*rho,0,( ...
  1/12).*I11.*L.*rho,0,0;(1/3).*L.*Q2.*rho,0,0,0,(1/3).*I22.*L.*rho,(-1/3).* ...
  I23.*L.*rho,(1/6).*L.*Q2.*rho,0,0,0,(1/6).*I22.*L.*rho,(-1/6).*I23.*L.*rho,0,0, ...
  0,0,(1/12).*L.*Q2.*rho,0,(1/12).*I22.*L.*rho,(-1/12).*I23.*L.*rho;(-1/3).*L.* ...
  Q3.*rho,0,0,0,(-1/3).*I23.*L.*rho,(1/3).*I33.*L.*rho,(-1/6).*L.*Q3.*rho,0,0,0,( ...
  -1/6).*I23.*L.*rho,(1/6).*I33.*L.*rho,0,0,0,0,(-1/12).*L.*Q3.*rho,0,(-1/12).* ...
  I23.*L.*rho,(1/12).*I33.*L.*rho;(1/6).*A.*L.*rho,0,0,0,(1/6).*L.*Q2.*rho,(-1/6) ...
  .*L.*Q3.*rho,(1/3).*A.*L.*rho,0,0,0,(1/3).*L.*Q2.*rho,(-1/3).*L.*Q3.*rho,0,0,0, ...
  0,(1/12).*A.*L.*rho,0,(1/12).*L.*Q2.*rho,(-1/12).*L.*Q3.*rho;0,(1/6).*A.*L.*rho, ...
  0,(-1/6).*L.*Q2.*rho,0,0,0,(1/3).*A.*L.*rho,0,(-1/3).*L.*Q2.*rho,0,0,(1/12).* ...
  A.*L.*rho,0,(-1/120).*A.*L.*rho,0,0,(-1/12).*L.*Q2.*rho,0,0;0,0,(1/6).*A.*L.* ...
  rho,(1/6).*L.*Q3.*rho,0,0,0,0,(1/3).*A.*L.*rho,(1/3).*L.*Q3.*rho,0,0,0,(1/12).* ...
  A.*L.*rho,0,(-1/120).*A.*L.*rho,0,(1/12).*L.*Q3.*rho,0,0;0,(-1/6).*L.*Q2.*rho,( ...
  1/6).*L.*Q3.*rho,(1/6).*I11.*L.*rho,0,0,0,(-1/3).*L.*Q2.*rho,(1/3).*L.*Q3.*rho,( ...
  1/3).*I11.*L.*rho,0,0,(-1/12).*L.*Q2.*rho,(1/12).*L.*Q3.*rho,(1/120).*L.*Q2.* ...
  rho,(-1/120).*L.*Q3.*rho,0,(1/12).*I11.*L.*rho,0,0;(1/6).*L.*Q2.*rho,0,0,0,(1/6) ...
  .*I22.*L.*rho,(-1/6).*I23.*L.*rho,(1/3).*L.*Q2.*rho,0,0,0,(1/3).*I22.*L.*rho,( ...
  -1/3).*I23.*L.*rho,0,0,0,0,(1/12).*L.*Q2.*rho,0,(1/12).*I22.*L.*rho,(-1/12).* ...
  I23.*L.*rho;(-1/6).*L.*Q3.*rho,0,0,0,(-1/6).*I23.*L.*rho,(1/6).*I33.*L.*rho,( ...
  -1/3).*L.*Q3.*rho,0,0,0,(-1/3).*I23.*L.*rho,(1/3).*I33.*L.*rho,0,0,0,0,(-1/12) ...
  .*L.*Q3.*rho,0,(-1/12).*I23.*L.*rho,(1/12).*I33.*L.*rho;0,(1/12).*A.*L.*rho,0,( ...
  -1/12).*L.*Q2.*rho,0,0,0,(1/12).*A.*L.*rho,0,(-1/12).*L.*Q2.*rho,0,0,(1/30).* ...
  A.*L.*rho,0,0,0,0,(-1/30).*L.*Q2.*rho,0,0;0,0,(1/12).*A.*L.*rho,(1/12).*L.* ...
  Q3.*rho,0,0,0,0,(1/12).*A.*L.*rho,(1/12).*L.*Q3.*rho,0,0,0,(1/30).*A.*L.*rho,0, ...
  0,0,(1/30).*L.*Q3.*rho,0,0;0,(1/120).*A.*L.*rho,0,(-1/120).*L.*Q2.*rho,0,0,0,( ...
  -1/120).*A.*L.*rho,0,(1/120).*L.*Q2.*rho,0,0,0,0,(1/840).*A.*L.*rho,0,0,0,0,0; ...
  0,0,(1/120).*A.*L.*rho,(1/120).*L.*Q3.*rho,0,0,0,0,(-1/120).*A.*L.*rho,( ...
  -1/120).*L.*Q3.*rho,0,0,0,0,0,(1/840).*A.*L.*rho,0,0,0,0;(1/12).*A.*L.*rho,0, ...
  0,0,(1/12).*L.*Q2.*rho,(-1/12).*L.*Q3.*rho,(1/12).*A.*L.*rho,0,0,0,(1/12).*L.* ...
  Q2.*rho,(-1/12).*L.*Q3.*rho,0,0,0,0,(1/30).*A.*L.*rho,0,(1/30).*L.*Q2.*rho,( ...
  -1/30).*L.*Q3.*rho;0,(-1/12).*L.*Q2.*rho,(1/12).*L.*Q3.*rho,(1/12).*I11.*L.*rho, ...
  0,0,0,(-1/12).*L.*Q2.*rho,(1/12).*L.*Q3.*rho,(1/12).*I11.*L.*rho,0,0,(-1/30).* ...
  L.*Q2.*rho,(1/30).*L.*Q3.*rho,0,0,0,(1/30).*I11.*L.*rho,0,0;(1/12).*L.*Q2.*rho, ...
  0,0,0,(1/12).*I22.*L.*rho,(-1/12).*I23.*L.*rho,(1/12).*L.*Q2.*rho,0,0,0,(1/12) ...
  .*I22.*L.*rho,(-1/12).*I23.*L.*rho,0,0,0,0,(1/30).*L.*Q2.*rho,0,(1/30).*I22.* ...
  L.*rho,(-1/30).*I23.*L.*rho;(-1/12).*L.*Q3.*rho,0,0,0,(-1/12).*I23.*L.*rho,( ...
  1/12).*I33.*L.*rho,(-1/12).*L.*Q3.*rho,0,0,0,(-1/12).*I23.*L.*rho,(1/12).* ...
  I33.*L.*rho,0,0,0,0,(-1/30).*L.*Q3.*rho,0,(-1/30).*I23.*L.*rho,(1/30).*I33.* ...
  L.*rho];

%lumped mass
for i=1:length(constant.lumped.mass);
    for j=1:length(constant.lumped.mass{i});
        
        xi=constant.lumped.ecc{i}(j,1);
        ec2=constant.lumped.ecc{i}(j,2);
        ec3=constant.lumped.ecc{i}(j,3);
        % Convert global inertia properties to the local coordinate system
        IG=R'*constant.lumped.IG{i}(:,3*(j-1)+(1:3))*R;
       
        I11=IG(1,1);
        I22=IG(2,2);
        I23=IG(2,3);
        I33=IG(3,3);
        
        m=constant.lumped.mass{i}(j);
        
        Ml_lumped{i}(j,:,:)= [0.10e1 * m * ((1 - xi) ^ 2) 0 0 0 0.10e1 * m * ((1 - xi) ^ 2) * ec3 -0.10e1 * m * ((1 - xi) ^ 2) * ec2 0.10e1 * m * xi * (1 - xi) 0 0 0 0.10e1 * m * ec3 * xi * (1 - xi) -0.10e1 * m * ec2 * xi * (1 - xi) 0 0 0 0 0.10e1 * m * xi * ((1 - xi) ^ 2) 0 0.10e1 * m * ((1 - xi) ^ 2) * ec3 * xi -0.10e1 * m * ((1 - xi) ^ 2) * ec2 * xi; 0 0.10e1 * m * ((1 - xi) ^ 2) 0 -0.10e1 * m * ((1 - xi) ^ 2) * ec3 0 0 0 0.10e1 * m * xi * (1 - xi) 0 -0.10e1 * m * ec3 * xi * (1 - xi) 0 0 0.10e1 * m * xi * ((1 - xi) ^ 2) 0 0.10e1 * m * xi * ((1 - xi) ^ 2) * (0.1e1 / 0.2e1 - xi) 0 0 -0.10e1 * m * ((1 - xi) ^ 2) * ec3 * xi 0 0; 0 0 0.10e1 * m * ((1 - xi) ^ 2) 0.10e1 * m * ((1 - xi) ^ 2) * ec2 0 0 0 0 0.10e1 * m * xi * (1 - xi) 0.10e1 * m * ec2 * xi * (1 - xi) 0 0 0 0.10e1 * m * xi * ((1 - xi) ^ 2) 0 0.10e1 * m * xi * ((1 - xi) ^ 2) * (0.1e1 / 0.2e1 - xi) 0 0.10e1 * m * ((1 - xi) ^ 2) * ec2 * xi 0 0; 0 -0.10e1 * m * ((1 - xi) ^ 2) * ec3 0.10e1 * m * ((1 - xi) ^ 2) * ec2 0.10e1 * m * ((1 - xi) ^ 2) * (ec3 ^ 2 + ec2 ^ 2) + 0.10e1 * ((1 - xi) ^ 2) * I11 0 0 0 -0.10e1 * m * ec3 * xi * (1 - xi) 0.10e1 * m * ec2 * xi * (1 - xi) 0.10e1 * m * xi * (ec3 ^ 2 + ec2 ^ 2) * (1 - xi) + 0.10e1 * xi * I11 * (1 - xi) 0 0 -0.10e1 * m * ((1 - xi) ^ 2) * ec3 * xi 0.10e1 * m * ((1 - xi) ^ 2) * ec2 * xi -0.10e1 * m * xi * ((1 - xi) ^ 2) * (0.1e1 / 0.2e1 - xi) * ec3 0.10e1 * m * xi * ((1 - xi) ^ 2) * (0.1e1 / 0.2e1 - xi) * ec2 0 0.10e1 * m * xi * ((1 - xi) ^ 2) * (ec3 ^ 2 + ec2 ^ 2) + 0.10e1 * xi * ((1 - xi) ^ 2) * I11 0 0; 0.10e1 * m * ((1 - xi) ^ 2) * ec3 0 0 0 0.10e1 * m * ((1 - xi) ^ 2) * (ec3 ^ 2) + 0.10e1 * ((1 - xi) ^ 2) * I22 -0.10e1 * m * ((1 - xi) ^ 2) * ec2 * ec3 - 0.10e1 * ((1 - xi) ^ 2) * I23 0.10e1 * m * ec3 * xi * (1 - xi) 0 0 0 0.10e1 * m * (ec3 ^ 2) * xi * (1 - xi) + 0.10e1 * I22 * xi * (1 - xi) -0.10e1 * m * ec2 * ec3 * xi * (1 - xi) - 0.10e1 * I23 * xi * (1 - xi) 0 0 0 0 0.10e1 * m * ((1 - xi) ^ 2) * ec3 * xi 0 0.10e1 * m * ((1 - xi) ^ 2) * (ec3 ^ 2) * xi + 0.10e1 * ((1 - xi) ^ 2) * I22 * xi -0.10e1 * m * ((1 - xi) ^ 2) * ec2 * ec3 * xi - 0.10e1 * ((1 - xi) ^ 2) * I23 * xi; -0.10e1 * m * ((1 - xi) ^ 2) * ec2 0 0 0 -0.10e1 * m * ((1 - xi) ^ 2) * ec2 * ec3 - 0.10e1 * ((1 - xi) ^ 2) * I23 0.10e1 * m * ((1 - xi) ^ 2) * (ec2 ^ 2) + 0.10e1 * ((1 - xi) ^ 2) * I33 -0.10e1 * m * ec2 * xi * (1 - xi) 0 0 0 -0.10e1 * m * ec2 * ec3 * xi * (1 - xi) - 0.10e1 * I23 * xi * (1 - xi) 0.10e1 * m * (ec2 ^ 2) * xi * (1 - xi) + 0.10e1 * I33 * xi * (1 - xi) 0 0 0 0 -0.10e1 * m * ((1 - xi) ^ 2) * ec2 * xi 0 -0.10e1 * m * ((1 - xi) ^ 2) * ec2 * ec3 * xi - 0.10e1 * ((1 - xi) ^ 2) * I23 * xi 0.10e1 * m * ((1 - xi) ^ 2) * (ec2 ^ 2) * xi + 0.10e1 * ((1 - xi) ^ 2) * I33 * xi; 0.10e1 * m * xi * (1 - xi) 0 0 0 0.10e1 * m * ec3 * xi * (1 - xi) -0.10e1 * m * ec2 * xi * (1 - xi) 0.10e1 * m * (xi ^ 2) 0 0 0 0.10e1 * m * (xi ^ 2) * ec3 -0.10e1 * m * (xi ^ 2) * ec2 0 0 0 0 0.10e1 * m * (xi ^ 2) * (1 - xi) 0 0.10e1 * m * (xi ^ 2) * ec3 * (1 - xi) -0.10e1 * m * (xi ^ 2) * ec2 * (1 - xi); 0 0.10e1 * m * xi * (1 - xi) 0 -0.10e1 * m * ec3 * xi * (1 - xi) 0 0 0 0.10e1 * m * (xi ^ 2) 0 -0.10e1 * m * (xi ^ 2) * ec3 0 0 0.10e1 * m * (xi ^ 2) * (1 - xi) 0 0.10e1 * m * (xi ^ 2) * (1 - xi) * (0.1e1 / 0.2e1 - xi) 0 0 -0.10e1 * m * (xi ^ 2) * ec3 * (1 - xi) 0 0; 0 0 0.10e1 * m * xi * (1 - xi) 0.10e1 * m * ec2 * xi * (1 - xi) 0 0 0 0 0.10e1 * m * (xi ^ 2) 0.10e1 * m * (xi ^ 2) * ec2 0 0 0 0.10e1 * m * (xi ^ 2) * (1 - xi) 0 0.10e1 * m * (xi ^ 2) * (1 - xi) * (0.1e1 / 0.2e1 - xi) 0 0.10e1 * m * (xi ^ 2) * ec2 * (1 - xi) 0 0; 0 -0.10e1 * m * ec3 * xi * (1 - xi) 0.10e1 * m * ec2 * xi * (1 - xi) 0.10e1 * m * xi * (ec3 ^ 2 + ec2 ^ 2) * (1 - xi) + 0.10e1 * xi * I11 * (1 - xi) 0 0 0 -0.10e1 * m * (xi ^ 2) * ec3 0.10e1 * m * (xi ^ 2) * ec2 0.10e1 * m * (xi ^ 2) * (ec3 ^ 2 + ec2 ^ 2) + 0.10e1 * (xi ^ 2) * I11 0 0 -0.10e1 * m * (xi ^ 2) * ec3 * (1 - xi) 0.10e1 * m * (xi ^ 2) * ec2 * (1 - xi) -0.10e1 * m * (xi ^ 2) * (1 - xi) * (0.1e1 / 0.2e1 - xi) * ec3 0.10e1 * m * (xi ^ 2) * (1 - xi) * (0.1e1 / 0.2e1 - xi) * ec2 0 0.10e1 * m * (xi ^ 2) * (1 - xi) * (ec3 ^ 2 + ec2 ^ 2) + 0.10e1 * (xi ^ 2) * (1 - xi) * I11 0 0; 0.10e1 * m * ec3 * xi * (1 - xi) 0 0 0 0.10e1 * m * (ec3 ^ 2) * xi * (1 - xi) + 0.10e1 * I22 * xi * (1 - xi) -0.10e1 * m * ec2 * ec3 * xi * (1 - xi) - 0.10e1 * I23 * xi * (1 - xi) 0.10e1 * m * (xi ^ 2) * ec3 0 0 0 0.10e1 * m * (xi ^ 2) * (ec3 ^ 2) + 0.10e1 * (xi ^ 2) * I22 -0.10e1 * m * (xi ^ 2) * ec2 * ec3 - 0.10e1 * (xi ^ 2) * I23 0 0 0 0 0.10e1 * m * (xi ^ 2) * ec3 * (1 - xi) 0 0.10e1 * m * (xi ^ 2) * (ec3 ^ 2) * (1 - xi) + 0.10e1 * (xi ^ 2) * I22 * (1 - xi) -0.10e1 * m * (xi ^ 2) * ec2 * ec3 * (1 - xi) - 0.10e1 * (xi ^ 2) * I23 * (1 - xi); -0.10e1 * m * ec2 * xi * (1 - xi) 0 0 0 -0.10e1 * m * ec2 * ec3 * xi * (1 - xi) - 0.10e1 * I23 * xi * (1 - xi) 0.10e1 * m * (ec2 ^ 2) * xi * (1 - xi) + 0.10e1 * I33 * xi * (1 - xi) -0.10e1 * m * (xi ^ 2) * ec2 0 0 0 -0.10e1 * m * (xi ^ 2) * ec2 * ec3 - 0.10e1 * (xi ^ 2) * I23 0.10e1 * m * (xi ^ 2) * (ec2 ^ 2) + 0.10e1 * (xi ^ 2) * I33 0 0 0 0 -0.10e1 * m * (xi ^ 2) * ec2 * (1 - xi) 0 -0.10e1 * m * (xi ^ 2) * ec2 * ec3 * (1 - xi) - 0.10e1 * (xi ^ 2) * I23 * (1 - xi) 0.10e1 * m * (xi ^ 2) * (ec2 ^ 2) * (1 - xi) + 0.10e1 * (xi ^ 2) * I33 * (1 - xi); 0 0.10e1 * m * xi * ((1 - xi) ^ 2) 0 -0.10e1 * m * ((1 - xi) ^ 2) * ec3 * xi 0 0 0 0.10e1 * m * (xi ^ 2) * (1 - xi) 0 -0.10e1 * m * (xi ^ 2) * ec3 * (1 - xi) 0 0 0.10e1 * m * (xi ^ 2) * ((1 - xi) ^ 2) 0 0.10e1 * m * (xi ^ 2) * ((1 - xi) ^ 2) * (0.1e1 / 0.2e1 - xi) 0 0 -0.10e1 * m * (xi ^ 2) * ((1 - xi) ^ 2) * ec3 0 0; 0 0 0.10e1 * m * xi * ((1 - xi) ^ 2) 0.10e1 * m * ((1 - xi) ^ 2) * ec2 * xi 0 0 0 0 0.10e1 * m * (xi ^ 2) * (1 - xi) 0.10e1 * m * (xi ^ 2) * ec2 * (1 - xi) 0 0 0 0.10e1 * m * (xi ^ 2) * ((1 - xi) ^ 2) 0 0.10e1 * m * (xi ^ 2) * ((1 - xi) ^ 2) * (0.1e1 / 0.2e1 - xi) 0 0.10e1 * m * (xi ^ 2) * ((1 - xi) ^ 2) * ec2 0 0; 0 0.10e1 * m * xi * ((1 - xi) ^ 2) * (0.1e1 / 0.2e1 - xi) 0 -0.10e1 * m * xi * ((1 - xi) ^ 2) * (0.1e1 / 0.2e1 - xi) * ec3 0 0 0 0.10e1 * m * (xi ^ 2) * (1 - xi) * (0.1e1 / 0.2e1 - xi) 0 -0.10e1 * m * (xi ^ 2) * (1 - xi) * (0.1e1 / 0.2e1 - xi) * ec3 0 0 0.10e1 * m * (xi ^ 2) * ((1 - xi) ^ 2) * (0.1e1 / 0.2e1 - xi) 0 0.10e1 * m * (xi ^ 2) * ((1 - xi) ^ 2) * (0.1e1 / 0.2e1 - xi) ^ 2 0 0 -0.10e1 * m * (xi ^ 2) * ((1 - xi) ^ 2) * (0.1e1 / 0.2e1 - xi) * ec3 0 0; 0 0 0.10e1 * m * xi * ((1 - xi) ^ 2) * (0.1e1 / 0.2e1 - xi) 0.10e1 * m * xi * ((1 - xi) ^ 2) * (0.1e1 / 0.2e1 - xi) * ec2 0 0 0 0 0.10e1 * m * (xi ^ 2) * (1 - xi) * (0.1e1 / 0.2e1 - xi) 0.10e1 * m * (xi ^ 2) * (1 - xi) * (0.1e1 / 0.2e1 - xi) * ec2 0 0 0 0.10e1 * m * (xi ^ 2) * ((1 - xi) ^ 2) * (0.1e1 / 0.2e1 - xi) 0 0.10e1 * m * (xi ^ 2) * ((1 - xi) ^ 2) * (0.1e1 / 0.2e1 - xi) ^ 2 0 0.10e1 * m * (xi ^ 2) * ((1 - xi) ^ 2) * (0.1e1 / 0.2e1 - xi) * ec2 0 0; 0.10e1 * m * xi * ((1 - xi) ^ 2) 0 0 0 0.10e1 * m * ((1 - xi) ^ 2) * ec3 * xi -0.10e1 * m * ((1 - xi) ^ 2) * ec2 * xi 0.10e1 * m * (xi ^ 2) * (1 - xi) 0 0 0 0.10e1 * m * (xi ^ 2) * ec3 * (1 - xi) -0.10e1 * m * (xi ^ 2) * ec2 * (1 - xi) 0 0 0 0 0.10e1 * m * (xi ^ 2) * ((1 - xi) ^ 2) 0 0.10e1 * m * (xi ^ 2) * ((1 - xi) ^ 2) * ec3 -0.10e1 * m * (xi ^ 2) * ((1 - xi) ^ 2) * ec2; 0 -0.10e1 * m * ((1 - xi) ^ 2) * ec3 * xi 0.10e1 * m * ((1 - xi) ^ 2) * ec2 * xi 0.10e1 * m * xi * ((1 - xi) ^ 2) * (ec3 ^ 2 + ec2 ^ 2) + 0.10e1 * xi * ((1 - xi) ^ 2) * I11 0 0 0 -0.10e1 * m * (xi ^ 2) * ec3 * (1 - xi) 0.10e1 * m * (xi ^ 2) * ec2 * (1 - xi) 0.10e1 * m * (xi ^ 2) * (1 - xi) * (ec3 ^ 2 + ec2 ^ 2) + 0.10e1 * (xi ^ 2) * (1 - xi) * I11 0 0 -0.10e1 * m * (xi ^ 2) * ((1 - xi) ^ 2) * ec3 0.10e1 * m * (xi ^ 2) * ((1 - xi) ^ 2) * ec2 -0.10e1 * m * (xi ^ 2) * ((1 - xi) ^ 2) * (0.1e1 / 0.2e1 - xi) * ec3 0.10e1 * m * (xi ^ 2) * ((1 - xi) ^ 2) * (0.1e1 / 0.2e1 - xi) * ec2 0 0.10e1 * m * (xi ^ 2) * ((1 - xi) ^ 2) * (ec3 ^ 2 + ec2 ^ 2) + 0.10e1 * (xi ^ 2) * ((1 - xi) ^ 2) * I11 0 0; 0.10e1 * m * ((1 - xi) ^ 2) * ec3 * xi 0 0 0 0.10e1 * m * ((1 - xi) ^ 2) * (ec3 ^ 2) * xi + 0.10e1 * ((1 - xi) ^ 2) * I22 * xi -0.10e1 * m * ((1 - xi) ^ 2) * ec2 * ec3 * xi - 0.10e1 * ((1 - xi) ^ 2) * I23 * xi 0.10e1 * m * (xi ^ 2) * ec3 * (1 - xi) 0 0 0 0.10e1 * m * (xi ^ 2) * (ec3 ^ 2) * (1 - xi) + 0.10e1 * (xi ^ 2) * I22 * (1 - xi) -0.10e1 * m * (xi ^ 2) * ec2 * ec3 * (1 - xi) - 0.10e1 * (xi ^ 2) * I23 * (1 - xi) 0 0 0 0 0.10e1 * m * (xi ^ 2) * ((1 - xi) ^ 2) * ec3 0 0.10e1 * m * (xi ^ 2) * ((1 - xi) ^ 2) * (ec3 ^ 2) + 0.10e1 * (xi ^ 2) * ((1 - xi) ^ 2) * I22 -0.10e1 * m * (xi ^ 2) * ((1 - xi) ^ 2) * ec2 * ec3 - 0.10e1 * (xi ^ 2) * ((1 - xi) ^ 2) * I23; -0.10e1 * m * ((1 - xi) ^ 2) * ec2 * xi 0 0 0 -0.10e1 * m * ((1 - xi) ^ 2) * ec2 * ec3 * xi - 0.10e1 * ((1 - xi) ^ 2) * I23 * xi 0.10e1 * m * ((1 - xi) ^ 2) * (ec2 ^ 2) * xi + 0.10e1 * ((1 - xi) ^ 2) * I33 * xi -0.10e1 * m * (xi ^ 2) * ec2 * (1 - xi) 0 0 0 -0.10e1 * m * (xi ^ 2) * ec2 * ec3 * (1 - xi) - 0.10e1 * (xi ^ 2) * I23 * (1 - xi) 0.10e1 * m * (xi ^ 2) * (ec2 ^ 2) * (1 - xi) + 0.10e1 * (xi ^ 2) * I33 * (1 - xi) 0 0 0 0 -0.10e1 * m * (xi ^ 2) * ((1 - xi) ^ 2) * ec2 0 -0.10e1 * m * (xi ^ 2) * ((1 - xi) ^ 2) * ec2 * ec3 - 0.10e1 * (xi ^ 2) * ((1 - xi) ^ 2) * I23 0.10e1 * m * (xi ^ 2) * ((1 - xi) ^ 2) * (ec2 ^ 2) + 0.10e1 * (xi ^ 2) * ((1 - xi) ^ 2) * I33;];
    end
end
        



